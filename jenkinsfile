pipeline{
    agent any
    stages{
        stage("build"){
            steps{
                when {
                expression{env.BRANCH_NAME != 'master'}
            }
                script{
                sh "docker build -t app ."
                sh "docker tag app echoapp:${env.BRANCH_NAME}-${env.GIT_COMMIT}"
                sh "echo built and tagged succssesfully"
                } 
               
                when {
                expression{env.BRANCH_NAME == 'master'}
            }
                script{
                sh "docker build -t app ."
                sh "docker tag app echoapp:1.0.${JENKINS_BUILD_NUMBER}"
                sh "echo built and tagged succssesfully"
                }
            }
        }
        stage("push"){
            when {
                expression{env.BRANCH_NAME == 'dev'}
            }
            steps{
                script{
                
                } 
            }
        }
    }
}